<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <title>Task - 3</title>

    <!-- Don't use this in production: -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin>
    </script>

    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin>
    </script>


    <!--
    Note: this page is a great way to try React but it's not suitable for production.
    It slowly compiles JSX with Babel in the browser and uses a large development build of React.
  -->

    <link rel="stylesheet" href="index.css">

    <script defer type="text/babel" src="index.js">
    </script>




</head>

<body>

    <div id="response-headers" style="display: none;">
        Response headers
    </div>
    <pre id="response-headers-json"></pre>


    <div id="response-body" style="display: none; margin-top: 20px; margin-bottom: 20px;">
        Response body
    </div>
    <pre id="response-body-json"></pre>

    <button style="margin-top: 50px;" id="post-api" onClick="callApi()"> Fetch post api</button>

    <script type="text/javascript">
        const btn = document.getElementById("post-api");

        const callApi = () => {
            fetch("https://chimpu.xyz/api/post.php", {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    "Post": "phonenumber"
                })
            }).then((response) => {
                if (!response.ok) {
                    console.log("status code ", response.status)
                } else {
                    console.log("All ok")

                    const responseHeadersDiv = document.getElementById("response-headers")
                    const responseHeadersPreTag = document.getElementById("response-headers-json")

                    responseHeadersDiv.style.display = "block";
                    const responseHeaderList = [...response.headers];
                    // console.log(...response.headers)
                    console.log(responseHeaderList[0])
                    const jsonDataList = [];

                    responseHeaderList.forEach((item) => {
                        jsonDataList.push(item);
                    })

                    const jsonData = []
                    for (let i = 0; i < jsonDataList.length; i++) {
                        const key = jsonDataList[i][0];
                        const value = jsonDataList[i][1];
                        console.log("data",)
                        jsonData.push({
                            [key]: value
                        })
                    }


                    responseHeadersPreTag.textContent = JSON.stringify(jsonData, undefined, 2);

                    return response.json();
                }
            }).then((data) => {
                const responseBodyDiv = document.getElementById("response-body")
                const responseBodyPreTag = document.getElementById("response-body-json")

                responseBodyDiv.style.display = "block";
                responseBodyPreTag.textContent = JSON.stringify(data, undefined, 2);


                console.log("data", data);
            })
                .catch((err) => {
                    console.log("error", err);
                });

        }

    </script>
</body>

</html>